#!/bin/sh
# .husky/pre-push
# ======================================================
# Hook Git ‚Äî Talent√âk√¥
# ------------------------------------------------------
# Objectif :
# - V√©rifier la qualit√© du code avant un git push
# - Bloquer le push en cas d'erreurs Twig ou tests √©chou√©s
# ======================================================

echo "üöÄ V√©rifications pre-push Talent√âk√¥..."

# 1) TwigCS strict (erreurs bloquantes)
echo "‚û°Ô∏è V√©rification TwigCS..."
composer exec twigcs -- templates/ --severity error || {
  echo "‚ùå Erreurs Twig d√©tect√©es ‚Äî corrige avant de push."
  exit 1
}

# 2) Tests PHPUnit (unitaires + fonctionnels)
echo "‚û°Ô∏è Tests PHPUnit..."
composer exec phpunit -- --stop-on-failure || {
  echo "‚ùå Tests √©chou√©s ‚Äî corrige avant de push."
  exit 1
}

echo "‚úÖ Pre-push termin√©, push autoris√© !"

