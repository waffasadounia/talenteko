{# ==========================================
  Partial Twig : Champ mot de passe
  ========================================== #}

{% set is_invalid = (form_errors(field) is not empty) %}
{% set errors_id = field.vars.id ~ '-errors' %}

<div class="space-y-1">
  <label for="{{ field.vars.id }}" class="form-label">
    {{ label }} <span class="form-required" aria-hidden="true">*</span>
  </label>

  {{ form_widget(field, {
    attr: {
      placeholder: '••••••••',
      class: 'form-input' ~ (is_invalid ? ' is-invalid' : ''),
      'aria-invalid': is_invalid ? 'true' : 'false',
      'aria-describedby': is_invalid ? errors_id : null,
      'data-password-strength-target': target == 'original' ? 'input' : null,
      'data-password-confirm-target': target,
      'data-action': target == 'original'
        ? 'input->password-strength#check input->password-confirm#check'
        : 'input->password-confirm#check'
    }
  }) }}

  {% if is_invalid %}
    <p id="{{ errors_id }}" class="form-error" role="alert">
      {{ form_errors(field) }}
    </p>
  {% endif %}

  {# Zone de feedback Stimulus (accessibilité aria-live) #}
  <p class="text-xs mt-1"
     aria-live="polite"
     {% if target == 'original' %}
       data-password-strength-target="feedback"
     {% elseif target == 'confirm' %}
       data-password-confirm-target="feedback"
     {% endif %}></p>
</div>
