{# ================================
  partials/_listing_card.html.twig
  Carte annonce TalentÃƒÆ’Ã†â€™Ãƒâ€ Ã¢â‚¬â„¢ÃƒÆ’Ã¢â‚¬Å¡Ãƒâ€šÃ‚Â©ko (V2 homogÃ©nÃ©rÃ©e)
  ================================ #}

<div
  class="relative overflow-hidden rounded-xl border border-gray-200 bg-white shadow-sm transition hover:shadow-md"
>
  {# --- Bouton Favoris (Stimulus toggle) --- #}
  <button
    type="button"
    class="text-talenteko-orange-400 hover:bg-talenteko-orange-100 hover:text-talenteko-orange-500 absolute top-2 right-2 flex h-9 w-9 items-center justify-center rounded-full bg-white shadow transition"
    aria-label="Ajouter ou retirer des favoris"
    data-controller="favorite-toggle"
    data-action="click->favorite-toggle#toggle"
  >
    <span data-favorite-toggle-target="empty">
      <i class="fa-regular fa-heart" aria-hidden="true"></i>
    </span>
    <span data-favorite-toggle-target="filled" class="hidden">
      <i class="fa-solid fa-heart" aria-hidden="true"></i>
    </span>
  </button>

  {# --- Image principale (rÃƒÆ’Ã†â€™Ãƒâ€ Ã¢â‚¬â„¢ÃƒÆ’Ã¢â‚¬Å¡Ãƒâ€šÃ‚Â©elle si connectÃƒÆ’Ã†â€™Ãƒâ€ Ã¢â‚¬â„¢ÃƒÆ’Ã¢â‚¬Å¡Ãƒâ€šÃ‚Â©e, sinon placeholder) --- #}
  <a
    href="{{
    path(
      'app_listing_show',
      {
        slug: listing.slug
      }
    )
    }}"
    class="focus-visible:ring-talenteko-orange-500 block rounded-t-xl focus:outline-none focus-visible:ring-2"
  >
    <div class="h-40 w-full overflow-hidden bg-white">
      {% if (listing.images|length) > 0 %}
        <img
          src="{{ asset(
            'uploads/listings/' ~ listing.category.slug ~ '/'
              ~ listing.images|first.path
          )|imagine_filter('listing_card') }}"
          alt="Image du listing {{ listing.title|e }}"
          class="h-full w-full bg-gray-200 object-cover"
          loading="lazy"
          width="400"
          height="225"
        />
      {% else %}
        <img
          src="{{ asset('images/placeholders/placeholder.png') }}"
          alt="Image non disponible"
          class="h-full w-full bg-gray-200 object-cover"
          loading="lazy"
          width="400"
          height="225"
        />
      {% endif %}
    </div>
    {# --- Contenu texte --- #}
    <div class="flex flex-col gap-2 p-4">
      {# catÃ©gorie (fallback si null) #}
      <span
        class="text-talenteko-orange-500 inline-block text-xs font-semibold"
      >
        {{ listing.category.name ?? 'Non classÃƒÆ’Ã†â€™Ãƒâ€ Ã¢â‚¬â„¢ÃƒÆ’Ã¢â‚¬Å¡Ãƒâ€šÃ‚Â©e' }}
      </span>

      {# Titre cliquable #}
      <h3 class="text-talenteko-blue line-clamp-1 text-base font-bold">
        <a
          href="{{
          path(
            'app_listing_show',
            {
              slug: listing.slug
            }
          )
          }}"
          class="focus-visible:ring-talenteko-orange-500 rounded hover:underline focus:outline-none focus-visible:ring-2"
        >
          {{ listing.title }}
        </a>
      </h3>

      {# Description tronquÃƒÆ’Ã†â€™Ãƒâ€ Ã¢â‚¬â„¢ÃƒÆ’Ã¢â‚¬Å¡Ãƒâ€šÃ‚Â©e (2 lignes max) #}
      <p class="text-talenteko-blue-600 line-clamp-2 text-sm">
        {{ listing.description }}
      </p>

      {# --- Footer : auteur + ville --- #}
      <div class="mt-3 flex items-center justify-between text-sm">
        <div class="flex items-center gap-2">
          <div
            class="bg-talenteko-peach-200 text-talenteko-orange-500 flex h-8 w-8 items-center justify-center rounded-full font-bold"
            aria-hidden="true"
          >
            {{ (listing.author.pseudo ?? 'M')|slice(0, 1)|upper }}
          </div>
          <span class="text-talenteko-blue text-sm font-medium">
            {{ listing.author.pseudo ?? 'Membre' }}
          </span>
        </div>

        {% if listing.location %}
          <span
            class="text-talenteko-blue-400 flex max-w-[100px] items-center gap-1 truncate text-xs"
          >
            <i
              class="fa fa-map-marker-alt text-talenteko-orange-500"
              aria-hidden="true"
            >

            </i>
            {{ listing.location }}
          </span>
        {% endif %}
      </div>
    </div>
  </a>
</div>







