{# ============================================================================
   HEADER RESPONSIVE — TalentÉkô

============================================================================ #}

{% set isUser = app.user is not null and app.user.id is not null %}

<header role="banner" class="bg-white dark:bg-talenteko-blue-900 shadow-sm" data-controller="header-nav">

    {# ======================
       LIGNE PRINCIPALE
    ====================== #}
    <div class="mx-auto w-full max-w-7xl flex items-center justify-between gap-6 px-6 py-3">

        {# 1 — LOGO (toujours visible) #}
        <a href="{{ path('app_home') }}" class="flex flex-col items-center text-center shrink-0">
            <img src="{{ asset('images/talenteko_logo.png') }}" alt="Logo TalentÉkô"
                 class="h-10 w-auto rounded-full object-contain"/>
            <span class="text-xs font-extrabold leading-tight">
                <span class="text-talenteko-blue-900 dark:text-white">Talent</span>
                <span class="text-talenteko-orange-500">Ékô</span>
            </span>
        </a>

        {# 2 — RECHERCHE (Desktop uniquement) #}
        <form action="{{ path('app_search') }}" method="get" role="search"
              class="relative hidden md:block min-w-[220px] max-w-xl flex-1">
            <input id="search-input" type="search" name="q" placeholder="Rechercher une compétence"
                   class="w-full rounded-full border border-talenteko-orange-500 py-2 pl-10 pr-4
                          text-talenteko-blue-900 placeholder-gray-400
                          focus:border-talenteko-orange-500 focus:ring-2 focus:ring-talenteko-orange-500
                          dark:bg-talenteko-blue-800 dark:text-white"/>
            <i class="fa fa-search absolute left-3 top-2.5 text-talenteko-orange-500"></i>
        </form>

        {# 3 — NAV / CTA / LOGIN (Desktop uniquement) #}
        <div class="hidden md:flex items-center gap-6 whitespace-nowrap">

            <nav class="flex items-center gap-6">
                <a href="{{ path('app_search') }}" class="nav-link hover:text-talenteko-orange-600 hover:underline">
                    <i class="fa fa-search"></i><span>Recherche</span>
                </a>

                {% if isUser %}
                    <a href="{{ path('app_profile_favoris') }}" class="nav-link hover:text-talenteko-orange-600 hover:underline">
                        <i class="fa fa-heart"></i><span>Favoris</span>
                    </a>

                    <a href="{{ path('app_messages') }}" class="nav-link hover:text-talenteko-orange-600 relative">
                        <i class="fa fa-envelope"></i><span>Messages</span>
                        {% if unreadCount|default(0) > 0 %}
                            <span class="absolute -top-2 -right-3 h-4 w-4 flex items-center justify-center rounded-full bg-talenteko-orange-600 text-[10px] text-white font-bold">
                                {{ unreadCount }}
                            </span>
                        {% endif %}
                    </a>
                {% endif %}
            </nav>

            <a href="{{ path('app_listing_new') }}" class="btn-outline flex items-center gap-2">
                <i class="fa fa-plus-circle"></i><span>Déposer</span>
            </a>

            {% if isUser %}
                <a href="{{ path('app_profile_dashboard') }}" class="btn-primary flex items-center gap-2">
                    <i class="fa fa-user-circle"></i><span>Mon espace</span>
                </a>

                <a href="{{ path('app_logout') }}" class="text-talenteko-orange-500 hover:text-talenteko-orange-600">
                    <i class="fa-solid fa-right-from-bracket text-lg"></i>
                </a>
            {% else %}
                <a href="{{ path('app_login') }}" class="btn-primary flex items-center gap-2">
                    <i class="fa fa-user"></i><span>Se connecter</span>
                </a>
            {% endif %}
        </div>

        {# 4 — BURGER (Mobile uniquement) #}
        <button class="md:hidden rounded-md p-2 text-talenteko-orange-500"
                aria-label="Ouvrir le menu" data-action="click->header-nav#toggle">
            <i class="fa fa-bars text-xl"></i>
        </button>

        {% include 'partials/_mobile_menu.html.twig' %}
    </div>


    {# ======================
       BARRE DES CATÉGORIES
       Desktop uniquement
    ====================== #}
    <nav class="hidden md:block border-b border-talenteko-orange-500 bg-white dark:bg-talenteko-blue-800"
         aria-label="Catégories populaires"
         data-controller="scroll-nav">

        <div class="mx-auto max-w-7xl flex items-center px-6">

            <button type="button" class="hidden md:flex p-2 text-talenteko-orange-500"
                    data-action="click->scroll-nav#scrollLeft">
                <i class="fa fa-chevron-left text-lg"></i>
            </button>

            <div class="flex-1 overflow-x-auto scrollbar-hide scroll-smooth"
                 data-scroll-nav-target="container">

                <ul class="flex items-center gap-4 py-3 min-w-max">

                    {% set categories = [
                        'Bricolage','Bien-être','Jardinage','Éducation',
                        'Informatique','Langues','Art','Cuisine',
                        'Sport','Marketing','Administratif','Juridique'
                    ] %}

                    {% for cat in categories %}
                        {% set slug = cat|lower|replace({
                            'é':'e','è':'e','ê':'e','ë':'e',
                            'à':'a','â':'a','ä':'a','î':'i','ï':'i',
                            'ô':'o','ö':'o','ù':'u','û':'u','ü':'u',
                            'ç':'c',' ':'-'
                        }) %}
                        <li>
                            <a href="{{ path('app_category_show', { slug: slug }) }}"
                               class="px-4 py-2 text-sm font-semibold rounded-full text-talenteko-blue-900 hover:text-talenteko-orange-600">
                                {{ cat }}
                            </a>
                        </li>
                    {% endfor %}
                </ul>

            </div>

            <button type="button" class="hidden md:flex p-2 text-talenteko-orange-500"
                    data-action="click->scroll-nav#scrollRight">
                <i class="fa fa-chevron-right text-lg"></i>
            </button>

        </div>
    </nav>

</header>
