{# =======================================================
   Partial: Form Field
   Champ générique : label + input + erreurs
   Compatible avec .form-input / .form-error / .form-error-block
   ======================================================= #}

{% set is_invalid = form_errors(field)|length > 0 %}
{% set errors_id = field.vars.id ~ '-errors' %}

{# Attributs du champ #}
{% set attrs = {
    placeholder: placeholder|default(''),
    class: 'form-input ' ~ (is_invalid ? 'is-invalid' : ''),
    autocomplete: autocomplete|default('off'),
    'aria-invalid': is_invalid ? 'true' : 'false',
    'aria-describedby': is_invalid ? errors_id : null
} %}

{# Si on ajoute des attributs supplémentaires #}
{% if attr_extra is defined %}
    {% set attrs = attrs|merge(attr_extra) %}
{% endif %}

<div class="space-y-1">

    {# ===== Label ===== #}
    <label for="{{ field.vars.id }}" class="form-label">
        {{ label }}
        {% if field.vars.required %}
            <span class="form-required">*</span>
        {% endif %}
    </label>

    {# ===== Input ===== #}
    {{ form_widget(field, { attr: attrs }) }}

    {# ===== Erreurs ===== #}
    {% if is_invalid %}
        <div id="{{ errors_id }}" class="form-error-block" role="alert">
            <i class="fa-solid fa-circle-exclamation"></i>
            <div>{{ form_errors(field) }}</div>
        </div>
    {% endif %}
</div>
